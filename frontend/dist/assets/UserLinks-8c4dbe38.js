import{u as q,a as z,r as t,j as i,D as B,d as J,L as p,e as K,E as O,P as Q,T as V,c as o,S as W,f as X,A as Y}from"./index-7ef793a2.js";function ge(){const{id:u}=q(),c=z(),[l,E]=t.useState(null),[r,y]=t.useState([]),[S,w]=t.useState([]),[Z,C]=t.useState([]);t.useState({title:"",url:"",file_url:"",category_id:null,color:"",image_url:""}),t.useState("url"),t.useState(null);const[ee,v]=t.useState(!1),[te,F]=t.useState(null),[se,I]=t.useState([]),[le,j]=t.useState("link"),[ie,L]=t.useState(null),[ae,N]=t.useState({title:"",url:"",file_url:"",category_id:null,color:"",image_url:""}),[ne,_]=t.useState("url"),[oe,T]=t.useState(null),[re,d]=t.useState(!1),[ce,g]=t.useState(null),[ue,m]=t.useState("link"),[f,P]=t.useState(1),k=5;t.useState(!1),t.useEffect(()=>{l&&!l.isAdmin&&(j("link"),v(!1),F(null),m("link"),d(!1),g(null))},[l]);const R=t.useMemo(()=>{const e={};for(const s of S)e[s.id]=s;return e},[S]),b=async()=>{const[e,s,H,$,G]=await Promise.all([o.get("/auth/me"),o.get("/links"),o.get("/categories"),o.get("/colors"),o.get("/schedules")]);E(e.data),y([...s.data].sort((a,n)=>a.title.localeCompare(n.title))),w([...H.data].sort((a,n)=>a.name.localeCompare(n.name))),C([...$.data].sort((a,n)=>(a.name||a.value).localeCompare(n.name||n.value))),I(G.data)};t.useEffect(()=>{b().catch(()=>c("/admin/login"))},[c]),t.useEffect(()=>{if(u&&r.length){const e=r.find(s=>s.id===Number(u));e&&(L(e.id),N({title:e.title,url:e.url,file_url:e.fileUrl??"",category_id:e.categoryId??null,color:e.color??"",image_url:e.imageUrl??""}),m(l!=null&&l.isAdmin&&e.fileUrl?"file":"link"),_("url"),T(null),d(!!e.fileUrl),g(null))}else L(null),d(!1),g(null),m("link")},[u,r]);const U=async e=>{confirm("Excluir link?")&&(await o.delete(`/links/${e}`),await b())},h=r.filter(e=>e.userId===(l==null?void 0:l.id));r.filter(e=>e.userId!==(l==null?void 0:l.id));const x=[...h].sort((e,s)=>e.title.localeCompare(s.title)),A=Math.ceil(x.length/k)||1,M=x.slice((f-1)*k,f*k),D=i.jsx(W,{children:i.jsx(X,{icon:i.jsx(p,{className:"w-3 h-3",style:{color:"var(--text-on-dark)"}}),title:"Dashboard",subtitle:"Gerencie seus links",children:i.jsx(Y,{user:l})})});return i.jsx(B,{title:"Meus Links",subtitle:"Gerencie seus links pessoais",sidebar:D,className:"grid gap-4 grid-cols-1",children:i.jsx(J,{title:"Meus Links",subtitle:`${h.length} links criados`,icon:i.jsx(p,{className:"w-4 h-4 text-blue-600"}),page:f,pageCount:A,onPageChange:P,onAdd:()=>c("/user/links/new"),addLabel:"Novo Link",children:M.map(e=>{const s=R[e.categoryId||0];return i.jsx(K,{title:e.title,subtitle:e.url||"Sem URL",icon:p,iconColor:e.color||(s==null?void 0:s.color)||"#3b82f6",badge:s?{text:s.name,variant:"default"}:void 0,actions:[{icon:O,label:"Abrir",onClick:()=>window.open(e.url,"_blank")},{icon:Q,label:"Editar",onClick:()=>c(`/user/links/edit/${e.id}`)},{icon:V,label:"Excluir",onClick:()=>U(e.id),variant:"danger"}]},e.id)})})})}export{ge as default};
